<!--
  Generated template for the CalendarDeatilpagePage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header *ngIf="change">
    <ion-navbar color="gongdan-color" hideBackButton="true">
        <ion-buttons left>
            <button ion-button icon-only tappable (click)="changeCancel()" style="font-size:14px;color: white;margin-left: 10px">
                取消
            </button>
        </ion-buttons>
        <ion-buttons right>
            <button ion-button icon-only tappable (click)="changeFinish()" style="font-size:14px;color: white;margin-right: 10px">
                完成
            </button>
      </ion-buttons>
      <ion-title style="text-align: center">日程</ion-title>
    </ion-navbar>
</ion-header>

<ion-header *ngIf="!isEdit">
    <ion-navbar color="gongdan-color" hideBackButton="true">
        <ion-buttons left>
            <button ion-button icon-only (click)="goBack()">
              <ion-icon ios="ios-arrow-back" md="md-arrow-back"></ion-icon>
            </button>
          </ion-buttons>
      <ion-title>日程</ion-title>
    </ion-navbar>
</ion-header>


<ion-header *ngIf="isEdit && !change">
     <ion-navbar color="gongdan-color" hideBackButton="true">
        <ion-buttons left>
            <button ion-button icon-only tappable (click)="cancel()" style="font-size:14px;color: white;margin-left: 10px">
                取消
            </button>
        </ion-buttons>
        <ion-buttons right>
            <button ion-button icon-only tappable (click)="stateFinish()" style="font-size:14px;color: white;margin-right: 10px">
                完成
            </button>
      </ion-buttons>
      <ion-title style="text-align: center">新建</ion-title>
    </ion-navbar>
</ion-header>


<ion-content style="background-color: #f0f2f5">
   <div *ngIf="!isEdit">
        <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                <ion-label style="font-size: 13px;padding-left: 15px">类型
                    <span style="color: red">*</span>
                </ion-label>
                <p item-end style="font-size: 12px;margin-right: 15px;margin-top: 0px">{{item.type_name}}</p>
            </ion-item>
            <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                <ion-label  style="font-size: 13px;padding-left: 15px;max-width: 20%;">主题
                    <span style="color: red">*</span>
                </ion-label>
                <ion-label   style="text-align: right;font-size: 12px;margin-right: 15px;max-width: 80%;color: #999999;margin-left: 25px;white-space: pre-line">{{item.subject}}</ion-label>
            </ion-item>
            <ion-item no-lines style="min-height: 20px;border-bottom: #f0f2f5 1px solid;">
                    <ion-label style="color:#2e3133;font-size:13px;">负责人</ion-label>
                    <p item-end style="font-size:12px;margin-right: 15px;margin-top: 0px">{{item.partner_id_s.partner_id_s_name}}</p>
                    <!-- <img item-end src="assets/img/journal_sheet/right_icon.png" style="height:10px;"> -->
            </ion-item>
            <button ion-item  no-lines style="border-bottom:#f0f2f5 1px solid;">
                    <div style="position: relative;margin-bottom: -11px;margin-top: -11px">
                      <span style="    display: inline-block;
                        position: absolute;
                        top: calc(50% - 11px);display: inline-block;font-size: 13px"> 参与人员
                        <span style="color: red">*</span></span>
                
                      <div style="justify-content:space-around;white-space: pre-line;width: 200px;display: inline-block;
                      position: relative;top: -12px;
                      left: 88px;">
                        <span round style='background-color:#f0f2f5;flex :1 1 100%;color: #999999' *ngFor="let item of selectList" ion-button>
                                {{item.partner_name}}
                        </span>
                      </div>
                    </div>
                
            </button>
          <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                <ion-label style="font-size: 13px;padding-left: 15px">时间待定</ion-label>
                <ion-toggle [(ngModel)]="item.rt_is_sure_time"></ion-toggle>
           </ion-item>
          <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                 <ion-label style="font-size: 13px;padding-left: 15px">全天</ion-label>
                 <ion-toggle [(ngModel)]="item.allday"></ion-toggle>
           </ion-item>
          <ion-grid  *ngIf="!item.rt_is_sure_time" style="background-color: white;border-bottom: #f0f2f5 10px solid;">
              <ion-row style="height:100px;text-align:center;">
                  <ion-col col-5>
                  <div style="padding:1px;margin-left: 15dp;overflow:hidden;text-align:left">
                      <p text-wrap class="diyP" style="font-size:14px;color:#2e3033;width:70px;margin-left:15px">开始</p>
                      <p style="font-size:12px;color:#c2c7cc;line-height:12px;width:100px;margin-left:10px">{{item_start}}</p>
                  </div>
                  </ion-col>
                  <ion-col col-1>
                      <img src="assets/img/jiantou.png" style="width:15px;height:45px;margin-top: 10px">
                    </ion-col>
                  <ion-col col-5>
                  <div style="padding:1px;margin-left: 15dp;overflow:hidden;text-align:left">
                      <p text-wrap style="font-size:14px;color:#2e3033;width:35px;margin-left:15px">结束</p>
                      <p style="font-size:12px;color:#c2c7cc;line-height:12px;width:100px;margin-left:10px">{{item_stop}}</p>
                  </div>
                  </ion-col>
                </ion-row>
          </ion-grid>
         
          <ion-item-group *ngIf="!item.rt_is_sure_time">
            <ion-item no-lines style="min-height: 20px;border-bottom: #f0f2f5 1px solid;">
                <ion-label style="color:#2e3133;font-size:13px;">提醒</ion-label>
                <p item-end  style="font-size:12px;margin-right:15px;margin-top: 0px">{{item.rt_alarm_type_name}}</p>
            </ion-item>
            <!-- <ion-item no-lines style="min-height: 20px;">
                <ion-label style="color:#2e3133;font-size:13px;">重复</ion-label>
                <ion-note item-end style="color:#5C6166;font-size:12px;">{{recurrency}}</ion-note>
                <img item-end src="assets/img/journal_sheet/right_icon.png" style="height:10px;">
            </ion-item> -->
          </ion-item-group>
          <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;border-top: #f0f2f5 10px solid;">
                <ion-label style="font-size: 13px;padding-left: 15px">地点</ion-label>
                <p item-end style="font-size: 12px;padding-right: 10px;margin-top: 0px">{{item.location}}</p>
           </ion-item>
          <div style="padding: 1px;background-color: white;border-bottom:#f0f2f5 30px solid;">
            <p style="font-size: 13px;margin-left: 15px">内容</p>
            <div [innerHTML]="assembleHTML(description)" style="word-wrap:break-word;color:#c2c7cc;margin: 15px;padding: 10px;width:90%"></div>
          </div>
   </div>
   <div *ngIf="isEdit">
        <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;" tappable (click)="getType()">
                <ion-label style="font-size: 13px;padding-left: 15px">类型
                    <span style="color: red">*</span>
                </ion-label>
                <p item-end style="font-size: 12px;margin-right: -5px;">{{type_name}}</p>
                <img item-end src="assets/img/journal_sheet/right_icon.png" style="height:10px;">
            </ion-item>
            <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                <ion-label style="font-size: 13px;padding-left: 15px">主题
                    <span style="color: red">*</span>
                </ion-label>
                <ion-input type="text" text-right style="font-size: 13px;color: #8d9296" [(ngModel)]="subject" placeholder="请输入"></ion-input>
            </ion-item>
            <ion-item no-lines style="min-height: 20px;border-bottom: #f0f2f5 1px solid;" tappable (click)="selectPartnerId()">
                    <ion-label style="color:#2e3133;font-size:13px;">负责人</ion-label>
                    <p item-end style="font-size: 12px;margin-right: -5px">{{partner_id_s_name}}</p>
                    <img item-end src="assets/img/journal_sheet/right_icon.png" style="height:10px;">
            </ion-item>
            <button ion-item  no-lines (click)="selectPartner()" style="border-bottom:#f0f2f5 1px solid;">
                    <div style="position: relative;margin-bottom: -11px;margin-top: -11px">
                      <span style="    display: inline-block;
                        position: absolute;
                        top: calc(50% - 11px);display: inline-block;font-size: 13px">参与人员
                        <span style="color: red">*</span></span>
                
                      <div style="justify-content:space-around;white-space: pre-line;width: 200px;display: inline-block;
                      position: relative;top: -12px;
                      left: 88px;">
                        <span round style='background-color:#f0f2f5;flex :1 1 100%;color: #999999' *ngFor="let item of selectList" ion-button>
                                {{item.partner_name}}
                        </span>
                      </div>
                    </div>
                
                  </button>
            <!-- <ion-item no-lines tappable (click)="selectPartner()" style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                    <ion-label style="font-size: 13px;padding-left: 15px">参与人员</ion-label>
                    <p item-end style="font-size: 13px;background-color: #f0f2f5;border-radius: 15px;width: 60px;text-align: center">王小白</p>
                    <img item-end src="assets/img/journal_sheet/right_icon.png" style="height:10px;">
            </ion-item> -->
          <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                <ion-label style="font-size: 13px;padding-left: 15px">时间待定</ion-label>
                <ion-toggle [(ngModel)]="not_sure_time"  (ionChange)="notSureClick()"></ion-toggle>
           </ion-item>
          <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;">
                 <ion-label style="font-size: 13px;padding-left: 15px">全天</ion-label>
                 <ion-toggle [(ngModel)]="allDay"  (ionChange)="allDayClick()"></ion-toggle>
           </ion-item>
          <ion-grid  *ngIf="!not_sure_time" style="border-bottom: #f0f2f5 10px solid;background-color: white;">
              <ion-row style="height:100px;text-align:center;">
                  <ion-col col-5>
                  <div style="padding:1px;margin-left: 15dp;overflow:hidden;text-align:left">
                      <p text-wrap class="diyP" style="font-size:14px;color:#2e3033;width:70px;margin-left:5px">开始</p>
                      <ion-datetime *ngIf="!allDay" text-wrap cancelText="取消" doneText="确定"  [(ngModel)]="start_datetime"  min="2017-01" max="2100-12"
                         style="width: 160px;color:#5C6166;font-size:12px;margin-top: -15px;word-wrap:break-word;padding-left: 0px;padding-right: 0px;margin-left: 5px" displayFormat="YYYY年MM月DD日 HH:mm" pickerFormat="YYYY年 MM月 DD日 HH:mm"></ion-datetime>
                      <ion-datetime *ngIf="allDay" text-wrap cancelText="取消" doneText="确定"  [(ngModel)]="start_date"  min="2017-01" max="2100-12"
                         style="color:#5C6166;font-size:12px;margin-top: -15px;word-wrap:break-word;overflow:hidden;padding-left: 0px;padding-right: 0px;margin-left: 5px" displayFormat="YYYY年MM月DD日" pickerFormat="YYYY年 MM月 DD日"></ion-datetime>
                      <!-- <p style="font-size:12px;color:#c2c7cc;line-height:12px;width:100px;margin-left:10px">{{item.start}}</p> -->
                  </div>
                  </ion-col>
                  <ion-col col-1>
                      <img src="assets/img/jiantou.png" style="width:15px;height:45px;margin-top: 10px">
                    </ion-col>
                  <ion-col col-5>
                  <div style="padding:1px;margin-left: 15dp;overflow:hidden;text-align:left">
                      <p text-wrap style="font-size:14px;color:#2e3033;width:35px;margin-left:5px">结束</p>
                      <ion-datetime *ngIf="!allDay" text-wrap cancelText="取消" doneText="确定"  [(ngModel)]="stop_datetime"  min="2017-01" max="2100-12"
                         style="width: 160px;color:#5C6166;font-size:12px;margin-top: -15px;word-wrap:break-word;overflow:hidden;padding-left: 0px;padding-right: 0px;margin-left: 5px" displayFormat="YYYY年MM月DD日 HH:mm" pickerFormat="YYYY年 MM月 DD日 HH:mm"></ion-datetime>
                      <ion-datetime *ngIf="allDay" text-wrap cancelText="取消" doneText="确定"  [(ngModel)]="stop_date"  min="2017-01" max="2100-12"
                         style="color:#5C6166;font-size:12px;margin-top: -15px;word-wrap:break-word;padding-left: 0px;padding-right: 0px;margin-left: 5px" displayFormat="YYYY年MM月DD日" pickerFormat="YYYY年 MM月 DD日"></ion-datetime>
                  </div>
                  </ion-col>
                </ion-row>
          </ion-grid>
         
          <ion-item-group *ngIf="!not_sure_time">
            <ion-item no-lines style="min-height: 20px;border-bottom: #f0f2f5 1px solid;" tappable (click)="selectTip()">
                <ion-label style="color:#2e3133;font-size:13px;">提醒</ion-label>
                <p item-end style="font-size: 12px;margin-right: -5px">{{alarm_name}}</p>
                <img item-end src="assets/img/journal_sheet/right_icon.png" style="height:10px;">
            </ion-item>
            <!-- <ion-item no-lines style="min-height: 20px;" tappable (click)="selectRecurrency()">
                <ion-label style="color:#2e3133;font-size:13px;">重复</ion-label>
                <ion-note item-end style="color:#5C6166;font-size:12px;">{{recurrency}}</ion-note>
                <img item-end src="assets/img/journal_sheet/right_icon.png" style="height:10px;">
            </ion-item> -->
          </ion-item-group>
          <ion-item no-lines style="min-height: 20px;padding-left: 0px;border-bottom:#f0f2f5 1px solid;border-top: #f0f2f5 10px solid;">
                <ion-label style="font-size: 13px;padding-left: 15px">地点</ion-label>
                <ion-input type="text" text-right style="font-size: 12px;color: #abb0b4" [(ngModel)]="location" placeholder="请输入"></ion-input>
           </ion-item>
          <div style="padding: 1px;border-bottom: #f0f2f5 30px solid;background-color: white;">
            <p style="font-size: 13px;margin-left: 15px">内容</p>
            <textarea [(ngModel)]="description" cols="20"  placeholder="请输入" style="font-size: 12px;color: #abb0b4;height: 100px;padding: 10px;width: 100%;
                    border-bottom:white 0px solid;
                    border-top:white 0px solid;
                    border-left:white 0px solid;
                    border-right:white 0px solid;overflow-y: visible"></textarea>
          </div>
   </div>
</ion-content>


<ion-footer *ngIf="!isEdit" style="border-top:#f0f2f5 1px solid;background-color: white;">
    <div style="background:white" *ngIf="!isEdit">
        <span align="center" *ngIf="item.state" style='width:40%;float:right;background-color:#1897f2;height:44px;line-height:44px;font-size:15px;color:white' tappable (click)="finish()">
        标记完成
        </span>
        <span align="center" *ngIf="!item.state" style='width:40%;float:right;background-color:#1897f2;height:44px;line-height:44px;font-size:15px;color:white' tappable (click)="completion_event()">
        标记为待办
        </span>
        <span align="center" *ngIf="!item.state" style='width: 60%; float:right;height:44px;line-height:44px;font-size:15px;color: #1897f2' tappable (click)="delete()">
        删除
        </span>
        <span align="center" *ngIf="item.state" style='width: 30%; float:right;height:44px;line-height:44px;font-size:15px;color: #1897f2' tappable (click)="delete()">
        删除
        </span>
        <span align="center" *ngIf="item.state" style='width:30%;float:right;height:44px;line-height:44px;font-size:15px;color: #1897f2' tappable (click)="edit()">
        编辑
        </span>
    </div>
</ion-footer>
